{"version":3,"sources":["PropertyFieldGroupPickerHost.tsx"],"names":[],"mappings":"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","file":"PropertyFieldGroupPickerHost.js","sourcesContent":["/**\r\n * @file PropertyFieldGroupPickerHost.tsx\r\n * Renders the controls for PropertyFieldGroupPicker component\r\n *\r\n * @copyright 2017 Olivier Carpentier\r\n * Released under MIT licence\r\n *\r\n */\r\nimport * as React from 'react';\r\nimport { IPropertyFieldGroupPickerPropsInternal } from './PropertyFieldGroupPicker';\r\nimport { IWebPartContext } from '@microsoft/sp-webpart-base';\r\nimport { SPHttpClient, ISPHttpClientOptions, SPHttpClientResponse } from \"@microsoft/sp-http\";\r\nimport { EnvironmentType, Environment } from '@microsoft/sp-core-library';\r\nimport { IPropertyFieldGroup, IGroupType } from './PropertyFieldGroupPicker';\r\nimport { NormalPeoplePicker, IBasePickerSuggestionsProps } from 'office-ui-fabric-react/lib/Pickers';\r\nimport { Label } from 'office-ui-fabric-react/lib/Label';\r\nimport { IPersonaProps, PersonaPresence, PersonaInitialsColor } from 'office-ui-fabric-react/lib/Persona';\r\nimport { Async } from 'office-ui-fabric-react/lib/Utilities';\r\n\r\nimport * as strings from 'sp-client-custom-fields/strings';\r\n\r\n\r\n/**\r\n * @interface\r\n * PropertyFieldGroupPickerHost properties interface\r\n *\r\n */\r\nexport interface IPropertyFieldGroupPickerHostProps extends IPropertyFieldGroupPickerPropsInternal {\r\n}\r\n\r\n/**\r\n * @interface\r\n * Defines the state of the component\r\n *\r\n */\r\nexport interface IPeoplePickerState {\r\n  resultsPeople?: Array<IPropertyFieldGroup>;\r\n  resultsPersonas?: Array<IPersonaProps>;\r\n  errorMessage?: string;\r\n}\r\n\r\n/**\r\n * @class\r\n * Renders the controls for PropertyFieldGroupPicker component\r\n */\r\nexport default class PropertyFieldGroupPickerHost extends React.Component<IPropertyFieldGroupPickerHostProps, IPeoplePickerState> {\r\n\r\n  private searchService: PropertyFieldSearchService;\r\n  private intialPersonas: Array<IPersonaProps> = new Array<IPersonaProps>();\r\n  private resultsPeople: Array<IPropertyFieldGroup> = new Array<IPropertyFieldGroup>();\r\n  private resultsPersonas: Array<IPersonaProps> = new Array<IPersonaProps>();\r\n  private selectedPeople: Array<IPropertyFieldGroup> = new Array<IPropertyFieldGroup>();\r\n  private selectedPersonas: Array<IPersonaProps> = new Array<IPersonaProps>();\r\n  private async: Async;\r\n  private delayedValidate: (value: IPropertyFieldGroup[]) => void;\r\n\r\n  /**\r\n   * @function\r\n   * Constructor\r\n   */\r\n  constructor(props: IPropertyFieldGroupPickerHostProps) {\r\n    super(props);\r\n\r\n    this.searchService = new PropertyFieldSearchService(props.context);\r\n    this.onSearchFieldChanged = this.onSearchFieldChanged.bind(this);\r\n    this.onItemChanged = this.onItemChanged.bind(this);\r\n\r\n    this.createInitialPersonas();\r\n\r\n    this.state = {\r\n      resultsPeople: this.resultsPeople,\r\n      resultsPersonas: this.resultsPersonas,\r\n      errorMessage: ''\r\n    };\r\n\r\n    this.async = new Async(this);\r\n    this.validate = this.validate.bind(this);\r\n    this.notifyAfterValidate = this.notifyAfterValidate.bind(this);\r\n    this.delayedValidate = this.async.debounce(this.validate, this.props.deferredValidationTime);\r\n  }\r\n\r\n  /**\r\n   * @function\r\n   * Renders the PeoplePicker controls with Office UI  Fabric\r\n   */\r\n  public render(): JSX.Element {\r\n\r\n    var suggestionProps: IBasePickerSuggestionsProps = {\r\n      suggestionsHeaderText: strings.PeoplePickerSuggestedContacts,\r\n      noResultsFoundText: strings.PeoplePickerNoResults,\r\n      loadingText: strings.PeoplePickerLoading,\r\n    };\r\n\r\n    //Renders content\r\n    return (\r\n      <div>\r\n        <Label>{this.props.label}</Label>\r\n        <NormalPeoplePicker\r\n          pickerSuggestionsProps={suggestionProps}\r\n          onResolveSuggestions={this.onSearchFieldChanged}\r\n          onChange={this.onItemChanged}\r\n          defaultSelectedItems={this.intialPersonas}\r\n          />\r\n        { this.state.errorMessage != null && this.state.errorMessage != '' && this.state.errorMessage != undefined ?\r\n              <div style={{paddingBottom: '8px'}}><div aria-live='assertive' className='ms-u-screenReaderOnly' data-automation-id='error-message'>{  this.state.errorMessage }</div>\r\n              <span>\r\n                <p className='ms-TextField-errorMessage ms-u-slideDownIn20'>{ this.state.errorMessage }</p>\r\n              </span>\r\n              </div>\r\n            : ''}\r\n      </div>\r\n    );\r\n  }\r\n\r\n  /**\r\n   * @function\r\n   * A search field change occured\r\n   */\r\n  private onSearchFieldChanged(searchText: string, currentSelected: IPersonaProps[]): Promise<IPersonaProps> | IPersonaProps[] {\r\n    if (searchText.length > 2) {\r\n      //Clear the suggestions list\r\n      this.setState({ resultsPeople: this.resultsPeople, resultsPersonas: this.resultsPersonas });\r\n      //Request the search service\r\n      var result = this.searchService.searchGroups(searchText, this.props.groupType).then((response: IPropertyFieldGroup[]) => {\r\n        this.resultsPeople = [];\r\n        this.resultsPersonas = [];\r\n        //If allowDuplicate == false, so remove duplicates from results\r\n        if (this.props.allowDuplicate === false)\r\n          response = this.removeDuplicates(response);\r\n        response.map((element: IPropertyFieldGroup, index: number) => {\r\n          //Fill the results Array\r\n          this.resultsPeople.push(element);\r\n          //Transform the response in IPersonaProps object\r\n          this.resultsPersonas.push(this.getPersonaFromGroup(element, index));\r\n        });\r\n        //Refresh the component's state\r\n        this.setState({ resultsPeople: this.resultsPeople, resultsPersonas: this.resultsPersonas });\r\n        return this.resultsPersonas;\r\n      });\r\n      return result;\r\n    }\r\n    else {\r\n      return [];\r\n    }\r\n  }\r\n\r\n  /**\r\n   * @function\r\n   * Remove the duplicates if property allowDuplicate equals false\r\n   */\r\n  private removeDuplicates(responsePeople: IPropertyFieldGroup[]): IPropertyFieldGroup[] {\r\n    if (this.selectedPeople == null || this.selectedPeople.length == 0)\r\n      return responsePeople;\r\n    var res: IPropertyFieldGroup[] = [];\r\n    responsePeople.map((element: IPropertyFieldGroup) => {\r\n      var found: boolean = false;\r\n      for (var i: number = 0; i < this.selectedPeople.length; i++) {\r\n        var responseItem: IPropertyFieldGroup = this.selectedPeople[i];\r\n        if (responseItem.id == element.id) {\r\n          found = true;\r\n          break;\r\n        }\r\n      }\r\n      if (found === false)\r\n        res.push(element);\r\n    });\r\n    return res;\r\n  }\r\n\r\n  /**\r\n   * @function\r\n   * Creates the collection of initial personas from initial IPropertyFieldGroup collection\r\n   */\r\n  private createInitialPersonas(): void {\r\n    if (this.props.initialData == null || typeof (this.props.initialData) != typeof Array<IPropertyFieldGroup>())\r\n      return;\r\n    this.props.initialData.map((element: IPropertyFieldGroup, index: number) => {\r\n      var persona: IPersonaProps = this.getPersonaFromGroup(element, index);\r\n      this.intialPersonas.push(persona);\r\n      this.selectedPersonas.push(persona);\r\n      this.selectedPeople.push(element);\r\n    });\r\n  }\r\n\r\n  /**\r\n   * @function\r\n   * Generates a IPersonaProps object from a IPropertyFieldGroup object\r\n   */\r\n  private getPersonaFromGroup(element: IPropertyFieldGroup, index: number): IPersonaProps {\r\n    return {\r\n      primaryText: element.fullName, secondaryText: element.description\r\n    };\r\n  }\r\n\r\n\r\n  /**\r\n   * @function\r\n   * Refreshes the web part properties\r\n   */\r\n  private refreshWebPartProperties(): void {\r\n    this.delayedValidate(this.selectedPeople);\r\n  }\r\n\r\n   /**\r\n   * @function\r\n   * Validates the new custom field value\r\n   */\r\n  private validate(value: IPropertyFieldGroup[]): void {\r\n    if (this.props.onGetErrorMessage === null || this.props.onGetErrorMessage === undefined) {\r\n      this.notifyAfterValidate(this.props.initialData, value);\r\n      return;\r\n    }\r\n\r\n    var result: string | PromiseLike<string> = this.props.onGetErrorMessage(value || []);\r\n    if (result !== undefined) {\r\n      if (typeof result === 'string') {\r\n        if (result === undefined || result === '')\r\n          this.notifyAfterValidate(this.props.initialData, value);\r\n        this.state.errorMessage = result;\r\n        this.setState(this.state);\r\n      }\r\n      else {\r\n        result.then((errorMessage: string) => {\r\n          if (errorMessage === undefined || errorMessage === '')\r\n            this.notifyAfterValidate(this.props.initialData, value);\r\n          this.state.errorMessage = errorMessage;\r\n          this.setState(this.state);\r\n        });\r\n      }\r\n    }\r\n    else {\r\n      this.notifyAfterValidate(this.props.initialData, value);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * @function\r\n   * Notifies the parent Web Part of a property value change\r\n   */\r\n  private notifyAfterValidate(oldValue: IPropertyFieldGroup[], newValue: IPropertyFieldGroup[]) {\r\n    if (this.props.onPropertyChange && newValue != null) {\r\n      this.props.properties[this.props.targetProperty] = newValue;\r\n      this.props.onPropertyChange(this.props.targetProperty, oldValue, newValue);\r\n      if (!this.props.disableReactivePropertyChanges && this.props.render != null)\r\n        this.props.render();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * @function\r\n   * Called when the component will unmount\r\n   */\r\n  public componentWillUnmount() {\r\n    this.async.dispose();\r\n  }\r\n\r\n  /**\r\n   * @function\r\n   * Event raises when the user changed people from hte PeoplePicker component\r\n   */\r\n\r\n  private onItemChanged(selectedItems: IPersonaProps[]): void {\r\n    if (selectedItems.length > 0) {\r\n      if (selectedItems.length > this.selectedPersonas.length) {\r\n        var index: number = this.resultsPersonas.indexOf(selectedItems[selectedItems.length - 1]);\r\n        if (index > -1) {\r\n          var people: IPropertyFieldGroup = this.resultsPeople[index];\r\n          this.selectedPeople.push(people);\r\n          this.selectedPersonas.push(this.resultsPersonas[index]);\r\n          this.refreshWebPartProperties();\r\n        }\r\n      } else {\r\n        this.selectedPersonas.map((person, index2) => {\r\n            var selectedItemIndex: number = selectedItems.indexOf(person);\r\n            if (selectedItemIndex === -1) {\r\n              this.selectedPersonas.splice(index2, 1);\r\n              this.selectedPeople.splice(index2, 1);\r\n            }\r\n          });\r\n      }\r\n\r\n    } else {\r\n      this.selectedPersonas.splice(0, this.selectedPersonas.length);\r\n      this.selectedPeople.splice(0, this.selectedPeople.length);\r\n    }\r\n\r\n    this.refreshWebPartProperties();\r\n  }\r\n\r\n}\r\n\r\n/**\r\n * @interface\r\n * Service interface definition\r\n */\r\ninterface IPropertyFieldSearchService {\r\n  /**\r\n   * @function\r\n   * Search Groups from a query\r\n   */\r\n  searchGroups(query: string, type: IGroupType): Promise<Array<IPropertyFieldGroup>>;\r\n}\r\n\r\n/**\r\n * @class\r\n * Service implementation to search people in SharePoint\r\n */\r\nclass PropertyFieldSearchService implements IPropertyFieldSearchService {\r\n\r\n  private context: IWebPartContext;\r\n\r\n  /**\r\n   * @function\r\n   * Service constructor\r\n   */\r\n  constructor(pageContext: IWebPartContext) {\r\n    this.context = pageContext;\r\n  }\r\n\r\n  /**\r\n   * @function\r\n   * Search groups from the SharePoint database\r\n   */\r\n  public searchGroups(query: string, type: IGroupType): Promise<Array<IPropertyFieldGroup>> {\r\n    if (Environment.type === EnvironmentType.Local) {\r\n      //If the running environment is local, load the data from the mock\r\n      return this.searchGroupsFromMock(query);\r\n    }\r\n    else {\r\n      //If the running env is SharePoint, loads from the peoplepicker web service\r\n      var contextInfoUrl: string = this.context.pageContext.web.absoluteUrl + \"/_api/contextinfo\";\r\n      var userRequestUrl: string = this.context.pageContext.web.absoluteUrl + \"/_api/SP.UI.ApplicationPages.ClientPeoplePickerWebServiceInterface.clientPeoplePickerSearchUser\";\r\n      var httpPostOptions: ISPHttpClientOptions = {\r\n        headers: {\r\n          \"accept\": \"application/json\",\r\n          \"content-type\": \"application/json\"\r\n        }\r\n      };\r\n      return this.context.spHttpClient.post(contextInfoUrl, SPHttpClient.configurations.v1, httpPostOptions).then((response: SPHttpClientResponse) => {\r\n        return response.json().then((jsonResponse: any) => {\r\n          var formDigestValue: string = jsonResponse.FormDigestValue;\r\n          var data = {\r\n            'queryParams': {\r\n              //'__metadata': {\r\n              //    'type': 'SP.UI.ApplicationPages.ClientPeoplePickerQueryParameters'\r\n              //},\r\n              'AllowEmailAddresses': true,\r\n              'AllowMultipleEntities': false,\r\n              'AllUrlZones': false,\r\n              'MaximumEntitySuggestions': 20,\r\n              'PrincipalSource': 15,\r\n              //PrincipalType controls the type of entities that are returned in the results.\r\n              //Choices are All - 15, Distribution List - 2 , Security Groups - 4,\r\n              //SharePoint Groups &ndash; 8, User &ndash; 1. These values can be combined\r\n              'PrincipalType': type === IGroupType.SharePoint ? 8 : 4,\r\n              'QueryString': query\r\n              //'Required':false,\r\n              //'SharePointGroupID':null,\r\n              //'UrlZone':null,\r\n              //'UrlZoneSpecified':false,\r\n            }\r\n          };\r\n          httpPostOptions = {\r\n            headers: {\r\n              'accept': 'application/json',\r\n              'content-type': 'application/json',\r\n              \"X-RequestDigest\": formDigestValue\r\n            },\r\n            body: JSON.stringify(data)\r\n          };\r\n          return this.context.spHttpClient.post(userRequestUrl, SPHttpClient.configurations.v1, httpPostOptions).then((searchResponse: SPHttpClientResponse) => {\r\n            return searchResponse.json().then((usersResponse: any) => {\r\n              var res: IPropertyFieldGroup[] = [];\r\n              var values: any = JSON.parse(usersResponse.value);\r\n              values.map(element => {\r\n                var persona: IPropertyFieldGroup = {\r\n                  fullName: element.DisplayText,\r\n                  login: type === IGroupType.SharePoint ? element.EntityData.AccountName : element.ProviderName,\r\n                  id : type === IGroupType.SharePoint ? element.EntityData.SPGroupID : element.Key,\r\n                  description: element.Description\r\n                };\r\n                res.push(persona);\r\n              });\r\n              return res;\r\n            });\r\n          });\r\n        });\r\n      });\r\n    }\r\n  }\r\n\r\n\r\n  /**\r\n   * @function\r\n   * Returns fake people results for the Mock mode\r\n   */\r\n  private searchGroupsFromMock(query: string): Promise<Array<IPropertyFieldGroup>> {\r\n    return PeoplePickerMockHttpClient.searchGroups(this.context.pageContext.web.absoluteUrl).then(() => {\r\n      const results: IPropertyFieldGroup[] = [\r\n        { id: '1', fullName: \"Members\", login: \"Members\", description: 'Members' },\r\n        { id: '2', fullName: \"Viewers\", login: \"Viewers\", description: 'Viewers' },\r\n        { id: '3', fullName: \"Excel Services Viewers\", login: \"Excel Services Viewers\", description: 'Excel Services Viewers' }\r\n      ];\r\n      return results;\r\n    }) as Promise<Array<IPropertyFieldGroup>>;\r\n  }\r\n}\r\n\r\n/**\r\n * @class\r\n * Defines a http client to request mock data to use the web part with the local workbench\r\n */\r\nclass PeoplePickerMockHttpClient {\r\n\r\n  /**\r\n   * @var\r\n   * Mock SharePoint result sample\r\n   */\r\n  private static _results: IPropertyFieldGroup[] = [];\r\n\r\n  /**\r\n   * @function\r\n   * Mock search People method\r\n   */\r\n  public static searchGroups(restUrl: string, options?: any): Promise<IPropertyFieldGroup[]> {\r\n    return new Promise<IPropertyFieldGroup[]>((resolve) => {\r\n      resolve(PeoplePickerMockHttpClient._results);\r\n    });\r\n  }\r\n\r\n}"],"sourceRoot":"..\\src"}