{"version":3,"sources":["PropertyFieldSliderRange.ts"],"names":[],"mappings":";;AAAA;;;;;;;GAOG;AACH,6BAA+B;AAC/B,oCAAsC;AACtC,8DAIoC;AACpC,+EAAkH;AAClH,kDAAyD;AACzD,kEAA6D;AAmI7D;;;;GAIG;AACH;IA8BE;;;OAGG;IACH,yCAAmB,eAAuB,EAAE,WAAmD;QAhC/F,0CAA0C;QACnC,SAAI,GAA0B,uCAAqB,CAAC,MAAM,CAAC;QAmB1D,2BAAsB,GAAW,GAAG,CAAC;QAErC,mCAA8B,GAAY,KAAK,CAAC;QAWtD,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;QACrC,IAAI,CAAC,cAAc,GAAG,WAAW,CAAC,cAAc,CAAC;QACjD,IAAI,CAAC,UAAU,GAAG,WAAW,CAAC;QAC9B,IAAI,CAAC,KAAK,GAAG,WAAW,CAAC,KAAK,CAAC;QAC/B,IAAI,CAAC,YAAY,GAAG,WAAW,CAAC,YAAY,CAAC;QAC7C,IAAI,CAAC,QAAQ,GAAG,WAAW,CAAC,QAAQ,CAAC;QACrC,IAAI,CAAC,GAAG,GAAG,WAAW,CAAC,GAAG,CAAC;QAC3B,IAAI,CAAC,GAAG,GAAG,WAAW,CAAC,GAAG,CAAC;QAC3B,IAAI,CAAC,IAAI,GAAG,WAAW,CAAC,IAAI,CAAC;QAC7B,IAAI,CAAC,SAAS,GAAG,WAAW,CAAC,SAAS,CAAC;QACvC,IAAI,CAAC,WAAW,GAAG,WAAW,CAAC,WAAW,CAAC;QAC3C,IAAI,CAAC,IAAI,GAAG,WAAW,CAAC,IAAI,CAAC;QAC7B,IAAI,CAAC,UAAU,CAAC,SAAS,GAAG,IAAI,CAAC,OAAO,CAAC;QACzC,IAAI,CAAC,UAAU,CAAC,QAAQ,GAAG,IAAI,CAAC,MAAM,CAAC;QACvC,IAAI,CAAC,gBAAgB,GAAG,WAAW,CAAC,gBAAgB,CAAC;QACrD,IAAI,CAAC,gBAAgB,GAAG,WAAW,CAAC,UAAU,CAAC;QAC/C,IAAI,CAAC,GAAG,GAAG,WAAW,CAAC,GAAG,CAAC;QAC3B,IAAI,CAAC,iBAAiB,GAAG,WAAW,CAAC,iBAAiB,CAAC;QACvD,EAAE,CAAC,CAAC,WAAW,CAAC,sBAAsB,KAAK,SAAS,CAAC;YACnD,IAAI,CAAC,sBAAsB,GAAG,WAAW,CAAC,sBAAsB,CAAC;QACnE,IAAI,CAAC,aAAa,GAAG,WAAW,CAAC,MAAM,CAAC;QACxC,EAAE,CAAC,CAAC,WAAW,CAAC,8BAA8B,KAAK,SAAS,IAAI,WAAW,CAAC,8BAA8B,IAAI,IAAI,CAAC;YACjH,IAAI,CAAC,8BAA8B,GAAG,WAAW,CAAC,8BAA8B,CAAC;QAEnF,IAAI,CAAC,KAAK,GAAG,IAAI,iBAAK,CAAC,IAAI,CAAC,CAAC;QAC7B,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;QACzC,IAAI,CAAC,mBAAmB,GAAG,IAAI,CAAC,mBAAmB,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;QAC/D,IAAI,CAAC,eAAe,GAAG,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,IAAI,CAAC,QAAQ,EAAE,IAAI,CAAC,sBAAsB,CAAC,CAAC;QAEvF,6BAAiB,CAAC,OAAO,CAAC,kFAAkF,CAAC,CAAC;IAChH,CAAC;IAGD;;;OAGG;IACK,gDAAM,GAAd,UAAe,IAAiB;QAAhC,iBAqDC;QAnDC,8BAA8B;QAC9B,IAAM,OAAO,GAA2D,KAAK,CAAC,aAAa,CAAC,sCAA4B,EAAE;YACxH,KAAK,EAAE,IAAI,CAAC,KAAK;YACjB,YAAY,EAAE,IAAI,CAAC,YAAY;YAC/B,cAAc,EAAE,IAAI,CAAC,cAAc;YACnC,QAAQ,EAAE,IAAI,CAAC,QAAQ;YACvB,GAAG,EAAE,IAAI,CAAC,GAAG;YACb,GAAG,EAAE,IAAI,CAAC,GAAG;YACb,IAAI,EAAE,IAAI,CAAC,IAAI;YACf,WAAW,EAAE,IAAI,CAAC,WAAW;YAC7B,SAAS,EAAE,IAAI,CAAC,SAAS;YACzB,SAAS,EAAE,IAAI,CAAC,OAAO;YACvB,QAAQ,EAAE,IAAI,CAAC,MAAM;YACrB,gBAAgB,EAAE,IAAI,CAAC,gBAAgB;YACvC,IAAI,EAAE,IAAI,CAAC,IAAI;YACf,UAAU,EAAE,IAAI,CAAC,gBAAgB;YACjC,GAAG,EAAE,IAAI,CAAC,GAAG;YACb,iBAAiB,EAAE,IAAI,CAAC,iBAAiB;YACzC,sBAAsB,EAAE,IAAI,CAAC,sBAAsB;YACnD,MAAM,EAAE,IAAI,CAAC,aAAa;YAC1B,8BAA8B,EAAE,IAAI,CAAC,8BAA8B;SACpE,CAAC,CAAC;QACH,mCAAmC;QACnC,QAAQ,CAAC,MAAM,CAAC,OAAO,EAAE,IAAI,CAAC,CAAC;QAE/B,IAAI,SAAS,GAAG,6DAA6D,CAAC;QAC9E,IAAI,WAAW,GAAG,mEAAmE,CAAC;QAEtF,6BAAiB,CAAC,UAAU,CAAC,SAAS,EAAE,EAAE,iBAAiB,EAAE,GAAG,EAAE,CAAC,CAAC,IAAI,CAAC,UAAC,CAAM;YAC9E,6BAAiB,CAAC,UAAU,CAAC,WAAW,EAAE,EAAE,iBAAiB,EAAE,GAAG,EAAE,CAAC,CAAC,IAAI,CAAC,UAAC,QAAa;gBACpF,CAAS,CAAC,GAAG,GAAG,KAAI,CAAC,IAAI,GAAG,SAAS,CAAC,CAAC,MAAM,CAAC;oBAC7C,KAAK,EAAE,IAAI;oBACX,GAAG,EAAE,KAAI,CAAC,GAAG,IAAI,IAAI,GAAG,KAAI,CAAC,GAAG,GAAG,CAAC;oBACpC,GAAG,EAAE,KAAI,CAAC,GAAG,IAAI,IAAI,GAAG,KAAI,CAAC,GAAG,GAAG,GAAG;oBACtC,IAAI,EAAE,KAAI,CAAC,IAAI,IAAI,IAAI,GAAG,KAAI,CAAC,IAAI,GAAG,CAAC;oBACvC,QAAQ,EAAE,KAAI,CAAC,QAAQ,IAAI,IAAI,GAAG,KAAI,CAAC,QAAQ,GAAG,KAAK;oBACvD,WAAW,EAAE,KAAI,CAAC,WAAW,IAAI,IAAI,GAAG,KAAI,CAAC,WAAW,GAAG,YAAY;oBACvE,MAAM,EAAE,CAAC,KAAI,CAAC,YAAY,IAAI,IAAI,IAAI,KAAI,CAAC,YAAY,IAAI,EAAE,IAAI,KAAI,CAAC,YAAY,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,MAAM,IAAI,CAAC,CAAC,GAAG,CAAE,MAAM,CAAC,KAAI,CAAC,YAAY,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,MAAM,CAAC,KAAI,CAAC,YAAY,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,CAAE,GAAG,CAAC,KAAI,CAAC,GAAG,EAAE,KAAI,CAAC,GAAG,CAAC;oBACxN,KAAK,EAAE,UAAU,KAAK,EAAE,EAAE;wBACxB,IAAI,KAAK,GAAW,EAAE,CAAC,MAAM,CAAE,CAAC,CAAE,GAAG,GAAG,GAAG,EAAE,CAAC,MAAM,CAAE,CAAC,CAAC,CAAC;wBACzD,IAAI,CAAC,eAAe,CAAC,KAAK,CAAC,CAAC;wBAC5B;;;2BAGG;wBACF,CAAS,CAAC,GAAG,GAAG,IAAI,CAAC,IAAI,GAAG,MAAM,CAAC,CAAC,IAAI,CAAC,EAAE,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,CAAC;wBACvD,CAAS,CAAC,GAAG,GAAG,IAAI,CAAC,IAAI,GAAG,MAAM,CAAC,CAAC,IAAI,CAAC,EAAE,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,CAAC;oBAC1D,CAAC,CAAC,IAAI,CAAC,KAAI,CAAC;iBACb,CAAC,CAAC;YACP,CAAC,CAAC,CAAC;QACL,CAAC,CAAC,CAAC;IACL,CAAC;IAED;;;OAGG;IACK,kDAAQ,GAAhB,UAAiB,KAAa;QAA9B,iBA8BC;QA7BC,EAAE,CAAC,CAAC,IAAI,CAAC,iBAAiB,KAAK,IAAI,IAAI,IAAI,CAAC,iBAAiB,KAAK,SAAS,CAAC,CAAC,CAAC;YAC5E,IAAI,CAAC,mBAAmB,CAAC,IAAI,CAAC,YAAY,EAAE,KAAK,CAAC,CAAC;YACnD,MAAM,CAAC;QACT,CAAC;QAED,EAAE,CAAC,CAAC,IAAI,CAAC,mBAAmB,KAAK,KAAK,CAAC;YACrC,MAAM,CAAC;QACT,IAAI,CAAC,mBAAmB,GAAG,KAAK,CAAC;QAEjC,IAAI,MAAM,GAAiC,IAAI,CAAC,iBAAiB,CAAC,KAAK,IAAI,EAAE,CAAC,CAAC;QAC/E,EAAE,CAAC,CAAC,MAAM,KAAK,SAAS,CAAC,CAAC,CAAC;YACzB,EAAE,CAAC,CAAC,OAAO,MAAM,KAAK,QAAQ,CAAC,CAAC,CAAC;gBAC/B,EAAE,CAAC,CAAC,MAAM,KAAK,SAAS,IAAI,MAAM,KAAK,EAAE,CAAC;oBACxC,IAAI,CAAC,mBAAmB,CAAC,IAAI,CAAC,YAAY,EAAE,KAAK,CAAC,CAAC;gBACpD,CAAC,QAAQ,CAAC,cAAc,CAAC,IAAI,CAAC,IAAI,GAAG,aAAa,CAAC,CAAS,CAAC,SAAS,GAAG,MAAM,CAAC;gBAChF,CAAC,QAAQ,CAAC,cAAc,CAAC,IAAI,CAAC,IAAI,GAAG,aAAa,CAAC,CAAS,CAAC,SAAS,GAAG,MAAM,CAAC;YACnF,CAAC;YACD,IAAI,CAAC,CAAC;gBACJ,MAAM,CAAC,IAAI,CAAC,UAAC,YAAoB;oBAC/B,EAAE,CAAC,CAAC,YAAY,KAAK,SAAS,IAAI,YAAY,KAAK,EAAE,CAAC;wBACpD,KAAI,CAAC,mBAAmB,CAAC,KAAI,CAAC,YAAY,EAAE,KAAK,CAAC,CAAC;oBACpD,CAAC,QAAQ,CAAC,cAAc,CAAC,KAAI,CAAC,IAAI,GAAG,aAAa,CAAC,CAAS,CAAC,SAAS,GAAG,YAAY,CAAC;oBACtF,CAAC,QAAQ,CAAC,cAAc,CAAC,KAAI,CAAC,IAAI,GAAG,aAAa,CAAC,CAAS,CAAC,SAAS,GAAG,YAAY,CAAC;gBACzF,CAAC,CAAC,CAAC;YACL,CAAC;QACH,CAAC;QACD,IAAI,CAAC,CAAC;YACJ,IAAI,CAAC,mBAAmB,CAAC,IAAI,CAAC,YAAY,EAAE,KAAK,CAAC,CAAC;QACrD,CAAC;IACH,CAAC;IAED;;;OAGG;IACK,6DAAmB,GAA3B,UAA4B,QAAgB,EAAE,QAAgB;QAC5D,EAAE,CAAC,CAAC,IAAI,CAAC,gBAAgB,IAAI,QAAQ,IAAI,IAAI,CAAC,CAAC,CAAC;YAC9C,IAAI,CAAC,gBAAgB,CAAC,IAAI,CAAC,cAAc,CAAC,GAAG,QAAQ,CAAC;YACtD,IAAI,CAAC,gBAAgB,CAAC,IAAI,CAAC,cAAc,EAAE,IAAI,CAAC,UAAU,CAAC,YAAY,EAAE,QAAQ,CAAC,CAAC;YACnF,EAAE,CAAC,CAAC,CAAC,IAAI,CAAC,8BAA8B,IAAI,IAAI,CAAC,aAAa,IAAI,IAAI,CAAC;gBACrE,IAAI,CAAC,aAAa,EAAE,CAAC;QACzB,CAAC;IACH,CAAC;IAED;;;OAGG;IACK,iDAAO,GAAf,UAAgB,IAAiB;QAC/B,EAAE,CAAC,CAAC,IAAI,CAAC,KAAK,KAAK,SAAS,CAAC;YAC3B,IAAI,CAAC,KAAK,CAAC,OAAO,EAAE,CAAC;IACzB,CAAC;IAEH,sCAAC;AAAD,CAzLA,AAyLC,IAAA;AAGD;IACI,MAAM,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC,MAAM,EAAE,CAAC,GAAG,OAAO,CAAC,CAAC,QAAQ,CAAC,EAAE,CAAC,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC;AAC/E,CAAC;AAED;IACI,MAAM,CAAC,EAAE,EAAE,GAAG,EAAE,EAAE,GAAG,GAAG,GAAG,EAAE,EAAE,GAAG,GAAG,GAAG,EAAE,EAAE,GAAG,GAAG;QAChD,EAAE,EAAE,GAAG,GAAG,GAAG,EAAE,EAAE,GAAG,EAAE,EAAE,GAAG,EAAE,EAAE,CAAC;AACtC,CAAC;AAED;;;;;GAKG;AACH,kCAAyC,cAAsB,EAAE,UAA0C;IAEvG,gEAAgE;IAChE,IAAI,aAAa,GAA2C;QAC1D,KAAK,EAAE,UAAU,CAAC,KAAK;QACvB,cAAc,EAAE,cAAc;QAC9B,YAAY,EAAE,UAAU,CAAC,YAAY;QACrC,QAAQ,EAAE,UAAU,CAAC,QAAQ;QAC7B,GAAG,EAAE,UAAU,CAAC,GAAG;QACnB,GAAG,EAAE,UAAU,CAAC,GAAG;QACnB,IAAI,EAAE,UAAU,CAAC,IAAI;QACrB,SAAS,EAAE,UAAU,CAAC,SAAS;QAC/B,WAAW,EAAE,UAAU,CAAC,WAAW;QACnC,IAAI,EAAE,OAAO,EAAE;QACf,gBAAgB,EAAE,UAAU,CAAC,gBAAgB;QAC7C,UAAU,EAAE,UAAU,CAAC,UAAU;QACjC,SAAS,EAAE,IAAI;QACf,QAAQ,EAAE,IAAI;QACd,GAAG,EAAE,UAAU,CAAC,GAAG;QACnB,iBAAiB,EAAE,UAAU,CAAC,iBAAiB;QAC/C,sBAAsB,EAAE,UAAU,CAAC,sBAAsB;QACzD,MAAM,EAAE,UAAU,CAAC,MAAM;QACzB,8BAA8B,EAAE,UAAU,CAAC,8BAA8B;KAC1E,CAAC;IACF,mDAAmD;IACnD,iFAAiF;IACjF,MAAM,CAAC,IAAI,+BAA+B,CAAC,cAAc,EAAE,aAAa,CAAC,CAAC;AAC9E,CAAC;AA3BD,4DA2BC","file":"PropertyFieldSliderRange.js","sourcesContent":["/**\r\n * @file PropertyFieldSliderRange.ts\r\n * Define a custom field of type PropertyFieldSliderRange for\r\n * the SharePoint Framework (SPfx)\r\n *\r\n * @copyright 2016 Olivier Carpentier\r\n * Released under MIT licence\r\n */\r\nimport * as React from 'react';\r\nimport * as ReactDom from 'react-dom';\r\nimport {\r\n  IPropertyPaneField,\r\n  PropertyPaneFieldType,\r\n  IPropertyPaneCustomFieldProps\r\n} from '@microsoft/sp-webpart-base';\r\nimport PropertyFieldSliderRangeHost, { IPropertyFieldSliderRangeHostProps } from './PropertyFieldSliderRangeHost';\r\nimport { SPComponentLoader } from '@microsoft/sp-loader';\r\nimport { Async } from 'office-ui-fabric-react/lib/Utilities';\r\n\r\n/**\r\n * @interface\r\n * Public properties of the PropertyFieldSliderRange custom field\r\n *\r\n */\r\nexport interface IPropertyFieldSliderRangeProps {\r\n  /**\r\n   * @var\r\n   * Property field label displayed on top\r\n   */\r\n  label: string;\r\n  /**\r\n   * @var\r\n   * Initial value\r\n   */\r\n  initialValue?: string;\r\n  /**\r\n   * @var\r\n   * Disables the slider if set to true. Default is false.\r\n   */\r\n  disabled?: boolean;\r\n  /**\r\n   * @var\r\n   * The minimum value of the slider. Default is 0.\r\n   */\r\n  min?: number;\r\n  /**\r\n   * @var\r\n   * The maximum value of the slider. Default is 100.\r\n   */\r\n  max?: number;\r\n  /**\r\n   * @var\r\n   * Default 1 - Determines the size or amount of each interval or step the\r\n   * slider takes between the min and max. The full specified value range of the\r\n   * slider (max - min) should be evenly divisible by the step.\r\n   */\r\n  step?: number;\r\n  /**\r\n   * @var\r\n   * Determines whether the slider handles move horizontally (min on left,\r\n   * max on right) or vertically (min on bottom, max on top).\r\n   * Possible values: \"horizontal\", \"vertical\".\r\n   */\r\n  orientation?: string;\r\n  /**\r\n   * @var\r\n   * Display the value on left & right of the slider or not\r\n   */\r\n  showValue?: boolean;\r\n  /**\r\n   * @function\r\n   * Defines a onPropertyChange function to raise when the selected Color changed.\r\n   * Normally this function must be always defined with the 'this.onPropertyChange'\r\n   * method of the web part object.\r\n   */\r\n  onPropertyChange(propertyPath: string, oldValue: any, newValue: any): void;\r\n  /**\r\n   * @function\r\n   * This API is called to render the web part.\r\n   * Normally this function must be always defined with the 'this.render.bind(this)'\r\n   * method of the web part object.\r\n   */\r\n  render(): void;\r\n  /**\r\n   * This property is used to indicate the web part's PropertyPane interaction mode: Reactive or NonReactive.\r\n   * The default behaviour is Reactive.\r\n   */\r\n  disableReactivePropertyChanges?: boolean;\r\n  /**\r\n   * @var\r\n   * Parent Web Part properties\r\n   */\r\n  properties: any;\r\n  /**\r\n   * @var\r\n   * An UNIQUE key indicates the identity of this control\r\n   */\r\n  key?: string;\r\n  /**\r\n   * The method is used to get the validation error message and determine whether the input value is valid or not.\r\n   *\r\n   *   When it returns string:\r\n   *   - If valid, it returns empty string.\r\n   *   - If invalid, it returns the error message string and the text field will\r\n   *     show a red border and show an error message below the text field.\r\n   *\r\n   *   When it returns Promise<string>:\r\n   *   - The resolved value is display as error message.\r\n   *   - The rejected, the value is thrown away.\r\n   *\r\n   */\r\n   onGetErrorMessage?: (value: string) => string | Promise<string>;\r\n   /**\r\n    * Custom Field will start to validate after users stop typing for `deferredValidationTime` milliseconds.\r\n    * Default value is 200.\r\n    */\r\n   deferredValidationTime?: number;\r\n}\r\n\r\n/**\r\n * @interface\r\n * Private properties of the PropertyFieldSliderRange custom field.\r\n * We separate public & private properties to include onRender & onDispose method waited\r\n * by the PropertyFieldCustom, witout asking to the developer to add it when he's using\r\n * the PropertyFieldSliderRange.\r\n *\r\n */\r\nexport interface IPropertyFieldSliderRangePropsInternal extends IPropertyPaneCustomFieldProps {\r\n  label: string;\r\n  initialValue?: string;\r\n  targetProperty: string;\r\n  showValue?: boolean;\r\n  guid: string;\r\n  disabled?: boolean;\r\n  min?: number;\r\n  max?: number;\r\n  step?: number;\r\n  orientation?: string;\r\n  onRender(elem: HTMLElement): void;\r\n  onDispose(elem: HTMLElement): void;\r\n  onPropertyChange(propertyPath: string, oldValue: any, newValue: any): void;\r\n  render(): void;\r\n  disableReactivePropertyChanges?: boolean;\r\n  properties: any;\r\n  onGetErrorMessage?: (value: string) => string | Promise<string>;\r\n  deferredValidationTime?: number;\r\n}\r\n\r\n/**\r\n * @interface\r\n * Represents a PropertyFieldSliderRange object\r\n *\r\n */\r\nclass PropertyFieldSliderRangeBuilder implements IPropertyPaneField<IPropertyFieldSliderRangePropsInternal> {\r\n\r\n  //Properties defined by IPropertyPaneField\r\n  public type: PropertyPaneFieldType = PropertyPaneFieldType.Custom;\r\n  public targetProperty: string;\r\n  public properties: IPropertyFieldSliderRangePropsInternal;\r\n\r\n  //Custom properties\r\n  private label: string;\r\n  private initialValue: string;\r\n  private guid: string;\r\n  private disabled: boolean;\r\n  private min: number;\r\n  private max: number;\r\n  private step: number;\r\n  private orientation: string;\r\n  private showValue: boolean;\r\n\r\n  private onPropertyChange: (propertyPath: string, oldValue: any, newValue: any) => void;\r\n  private customProperties: any;\r\n  private key: string;\r\n  private onGetErrorMessage: (value: string) => string | Promise<string>;\r\n  private deferredValidationTime: number = 200;\r\n  private renderWebPart: () => void;\r\n  private disableReactivePropertyChanges: boolean = false;\r\n\r\n  private latestValidateValue: string;\r\n  private async: Async;\r\n  private delayedValidate: (value: string) => void;\r\n\r\n  /**\r\n   * @function\r\n   * Ctor\r\n   */\r\n  public constructor(_targetProperty: string, _properties: IPropertyFieldSliderRangePropsInternal) {\r\n    this.render = this.render.bind(this);\r\n    this.targetProperty = _properties.targetProperty;\r\n    this.properties = _properties;\r\n    this.label = _properties.label;\r\n    this.initialValue = _properties.initialValue;\r\n    this.disabled = _properties.disabled;\r\n    this.min = _properties.min;\r\n    this.max = _properties.max;\r\n    this.step = _properties.step;\r\n    this.showValue = _properties.showValue;\r\n    this.orientation = _properties.orientation;\r\n    this.guid = _properties.guid;\r\n    this.properties.onDispose = this.dispose;\r\n    this.properties.onRender = this.render;\r\n    this.onPropertyChange = _properties.onPropertyChange;\r\n    this.customProperties = _properties.properties;\r\n    this.key = _properties.key;\r\n    this.onGetErrorMessage = _properties.onGetErrorMessage;\r\n    if (_properties.deferredValidationTime !== undefined)\r\n      this.deferredValidationTime = _properties.deferredValidationTime;\r\n    this.renderWebPart = _properties.render;\r\n    if (_properties.disableReactivePropertyChanges !== undefined && _properties.disableReactivePropertyChanges != null)\r\n      this.disableReactivePropertyChanges = _properties.disableReactivePropertyChanges;\r\n\r\n    this.async = new Async(this);\r\n    this.validate = this.validate.bind(this);\r\n    this.notifyAfterValidate = this.notifyAfterValidate.bind(this);\r\n    this.delayedValidate = this.async.debounce(this.validate, this.deferredValidationTime);\r\n\r\n    SPComponentLoader.loadCss('//cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/themes/smoothness/jquery-ui.css');\r\n  }\r\n\r\n\r\n  /**\r\n   * @function\r\n   * Renders the ColorPicker field content\r\n   */\r\n  private render(elem: HTMLElement): void {\r\n\r\n    //Construct the JSX properties\r\n    const element: React.ReactElement<IPropertyFieldSliderRangeHostProps> = React.createElement(PropertyFieldSliderRangeHost, {\r\n      label: this.label,\r\n      initialValue: this.initialValue,\r\n      targetProperty: this.targetProperty,\r\n      disabled: this.disabled,\r\n      min: this.min,\r\n      max: this.max,\r\n      step: this.step,\r\n      orientation: this.orientation,\r\n      showValue: this.showValue,\r\n      onDispose: this.dispose,\r\n      onRender: this.render,\r\n      onPropertyChange: this.onPropertyChange,\r\n      guid: this.guid,\r\n      properties: this.customProperties,\r\n      key: this.key,\r\n      onGetErrorMessage: this.onGetErrorMessage,\r\n      deferredValidationTime: this.deferredValidationTime,\r\n      render: this.renderWebPart,\r\n      disableReactivePropertyChanges: this.disableReactivePropertyChanges\r\n    });\r\n    //Calls the REACT content generator\r\n    ReactDom.render(element, elem);\r\n\r\n    var jQueryCdn = '//cdnjs.cloudflare.com/ajax/libs/jquery/3.1.1/jquery.min.js';\r\n    var jQueryUICdn = '//cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js';\r\n\r\n    SPComponentLoader.loadScript(jQueryCdn, { globalExportsName: '$' }).then(($: any): void => {\r\n      SPComponentLoader.loadScript(jQueryUICdn, { globalExportsName: '$' }).then((jqueryui: any): void => {\r\n          ($ as any)('#' + this.guid + '-slider').slider({\r\n            range: true,\r\n            min: this.min != null ? this.min : 0,\r\n            max: this.max != null ? this.max : 100,\r\n            step: this.step != null ? this.step : 1,\r\n            disabled: this.disabled != null ? this.disabled : false,\r\n            orientation: this.orientation != null ? this.orientation : 'horizontal',\r\n            values: (this.initialValue != null && this.initialValue != '' && this.initialValue.split(\",\").length == 2) ? [ Number(this.initialValue.split(\",\")[0]), Number(this.initialValue.split(\",\")[1]) ] : [this.min, this.max],\r\n            slide: function( event, ui ) {\r\n              var value: string = ui.values[ 0 ] + \",\" + ui.values[ 1];\r\n              this.delayedValidate(value);\r\n              /*if (this.onPropertyChange && value != null) {\r\n                this.customProperties[this.targetProperty] = value;\r\n                this.onPropertyChange(this.targetProperty, this.initialValue, value);\r\n              }*/\r\n              ($ as any)('#' + this.guid + '-min').html(ui.values[0]);\r\n              ($ as any)('#' + this.guid + '-max').html(ui.values[1]);\r\n            }.bind(this)\r\n          });\r\n      });\r\n    });\r\n  }\r\n\r\n  /**\r\n   * @function\r\n   * Validates the new custom field value\r\n   */\r\n  private validate(value: string): void {\r\n    if (this.onGetErrorMessage === null || this.onGetErrorMessage === undefined) {\r\n      this.notifyAfterValidate(this.initialValue, value);\r\n      return;\r\n    }\r\n\r\n    if (this.latestValidateValue === value)\r\n      return;\r\n    this.latestValidateValue = value;\r\n\r\n    var result: string | PromiseLike<string> = this.onGetErrorMessage(value || '');\r\n    if (result !== undefined) {\r\n      if (typeof result === 'string') {\r\n        if (result === undefined || result === '')\r\n          this.notifyAfterValidate(this.initialValue, value);\r\n        ((document.getElementById(this.guid + '-errorMssg1')) as any).innerHTML = result;\r\n        ((document.getElementById(this.guid + '-errorMssg2')) as any).innerHTML = result;\r\n      }\r\n      else {\r\n        result.then((errorMessage: string) => {\r\n          if (errorMessage === undefined || errorMessage === '')\r\n            this.notifyAfterValidate(this.initialValue, value);\r\n          ((document.getElementById(this.guid + '-errorMssg1')) as any).innerHTML = errorMessage;\r\n          ((document.getElementById(this.guid + '-errorMssg2')) as any).innerHTML = errorMessage;\r\n        });\r\n      }\r\n    }\r\n    else {\r\n      this.notifyAfterValidate(this.initialValue, value);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * @function\r\n   * Notifies the parent Web Part of a property value change\r\n   */\r\n  private notifyAfterValidate(oldValue: string, newValue: string) {\r\n    if (this.onPropertyChange && newValue != null) {\r\n      this.customProperties[this.targetProperty] = newValue;\r\n      this.onPropertyChange(this.targetProperty, this.properties.initialValue, newValue);\r\n      if (!this.disableReactivePropertyChanges && this.renderWebPart != null)\r\n        this.renderWebPart();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * @function\r\n   * Disposes the current object\r\n   */\r\n  private dispose(elem: HTMLElement): void {\r\n    if (this.async !== undefined)\r\n      this.async.dispose();\r\n  }\r\n\r\n}\r\n\r\n\r\nfunction s4(): string {\r\n    return Math.floor((1 + Math.random()) * 0x10000).toString(16).substring(1);\r\n}\r\n\r\nfunction getGuid(): string {\r\n    return s4() + s4() + '-' + s4() + '-' + s4() + '-' +\r\n      s4() + '-' + s4() + s4() + s4();\r\n}\r\n\r\n/**\r\n * @function\r\n * Helper method to create the customer field on the PropertyPane.\r\n * @param targetProperty - Target property the custom field is associated to.\r\n * @param properties - Strongly typed custom field properties.\r\n */\r\nexport function PropertyFieldSliderRange(targetProperty: string, properties: IPropertyFieldSliderRangeProps): IPropertyPaneField<IPropertyFieldSliderRangePropsInternal> {\r\n\r\n    //Create an internal properties object from the given properties\r\n    var newProperties: IPropertyFieldSliderRangePropsInternal = {\r\n      label: properties.label,\r\n      targetProperty: targetProperty,\r\n      initialValue: properties.initialValue,\r\n      disabled: properties.disabled,\r\n      min: properties.min,\r\n      max: properties.max,\r\n      step: properties.step,\r\n      showValue: properties.showValue,\r\n      orientation: properties.orientation,\r\n      guid: getGuid(),\r\n      onPropertyChange: properties.onPropertyChange,\r\n      properties: properties.properties,\r\n      onDispose: null,\r\n      onRender: null,\r\n      key: properties.key,\r\n      onGetErrorMessage: properties.onGetErrorMessage,\r\n      deferredValidationTime: properties.deferredValidationTime,\r\n      render: properties.render,\r\n      disableReactivePropertyChanges: properties.disableReactivePropertyChanges\r\n    };\r\n    //Calls the PropertyFieldSliderRange builder object\r\n    //This object will simulate a PropertyFieldCustom to manage his rendering process\r\n    return new PropertyFieldSliderRangeBuilder(targetProperty, newProperties);\r\n}\r\n\r\n\r\n"],"sourceRoot":"..\\src"}