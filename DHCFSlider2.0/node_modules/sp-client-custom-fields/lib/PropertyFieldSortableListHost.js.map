{"version":3,"sources":["PropertyFieldSortableListHost.tsx"],"names":[],"mappings":"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","file":"PropertyFieldSortableListHost.js","sourcesContent":["/**\r\n * @file PropertyFieldSortableListHost.tsx\r\n * Renders the controls for PropertyFieldSortableList component\r\n *\r\n * @copyright 2016 Olivier Carpentier\r\n * Released under MIT licence\r\n *\r\n */\r\nimport * as React from 'react';\r\nimport { Label } from 'office-ui-fabric-react/lib/Label';\r\nimport { IChoiceGroupOption } from 'office-ui-fabric-react/lib/ChoiceGroup';\r\nimport { Spinner, SpinnerType } from 'office-ui-fabric-react/lib/Spinner';\r\nimport { IconButton, IButtonProps } from 'office-ui-fabric-react/lib/Button';\r\nimport { Checkbox } from 'office-ui-fabric-react/lib/Checkbox';\r\nimport { Async } from 'office-ui-fabric-react/lib/Utilities';\r\nimport GuidHelper from './GuidHelper';\r\nimport { IPropertyFieldSortableListPropsInternal, ISortableListOrder } from './PropertyFieldSortableList';\r\n\r\n/**\r\n * @interface\r\n * PropertyFieldSortableListHost properties interface\r\n *\r\n */\r\nexport interface IPropertyFieldSortableListHostProps extends IPropertyFieldSortableListPropsInternal {\r\n}\r\n\r\n/**\r\n * @interface\r\n * PropertyFieldSortableListHost state interface\r\n *\r\n */\r\nexport interface IPropertyFieldSortableListHostState {\r\n  results: IChoiceGroupOption[];\r\n  selectedKeys: string[];\r\n  errorMessage?: string;\r\n}\r\n\r\n/**\r\n * @class\r\n * Renders the controls for PropertyFieldSortableList component\r\n */\r\nexport default class PropertyFieldSortableListHost extends React.Component<IPropertyFieldSortableListHostProps, IPropertyFieldSortableListHostState> {\r\n\r\n  private async: Async;\r\n  private delayedValidate: (value: string[]) => void;\r\n  private _key: string;\r\n\r\n  /**\r\n   * @function\r\n   * Constructor\r\n   */\r\n  constructor(props: IPropertyFieldSortableListHostProps) {\r\n    super(props);\r\n\r\n    this._key = GuidHelper.getGuid();\r\n    this.onChanged = this.onChanged.bind(this);\r\n    this.state = {\r\n\t\t\tresults: this.props.items !== undefined ? this.props.items : [],\r\n      selectedKeys: this.props.selectedItems !== undefined ? this.props.selectedItems : [],\r\n      errorMessage: ''\r\n    };\r\n\r\n    this.sortDescending = this.sortDescending.bind(this);\r\n    this.sortAscending = this.sortAscending.bind(this);\r\n    this.async = new Async(this);\r\n    this.validate = this.validate.bind(this);\r\n    this.notifyAfterValidate = this.notifyAfterValidate.bind(this);\r\n    this.delayedValidate = this.async.debounce(this.validate, this.props.deferredValidationTime);\r\n\r\n    this.initDefaultValue();\r\n  }\r\n\r\n  /**\r\n   * Inits the default items checked values\r\n   */\r\n  private initDefaultValue(): void {\r\n    if (this.props.selectedItems !== undefined && this.props.selectedItems != null) {\r\n      for (var i = 0; i < this.props.selectedItems.length; i++) {\r\n        var currItem = this.props.selectedItems[i];\r\n        var choice: IChoiceGroupOption = this.getStateItemFromKey(currItem);\r\n        if (choice != null) {\r\n          choice.isChecked = true;\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Gets the item from key\r\n   * @param key\r\n   */\r\n  private getStateItemFromKey(key: string): IChoiceGroupOption {\r\n    for (var i = 0; i < this.state.results.length; i++) {\r\n      var currItem = this.state.results[i];\r\n      if (currItem.key === key)\r\n        return currItem;\r\n    }\r\n    return null;\r\n  }\r\n\r\n  /**\r\n   * @function\r\n   * Remove a string from the selected keys\r\n   */\r\n  private removeSelected(element: string): void {\r\n    var res = [];\r\n    for (var i = 0; i < this.state.selectedKeys.length; i++) {\r\n      if (this.state.selectedKeys[i] !== element)\r\n        res.push(this.state.selectedKeys[i]);\r\n    }\r\n    this.state.selectedKeys = res;\r\n    this.getStateItemFromKey(element).isChecked = false;\r\n    this.setState(this.state);\r\n  }\r\n\r\n  /**\r\n   * @function\r\n   * Raises when a list has been selected\r\n   */\r\n  private onChanged(element: React.FormEvent<HTMLElement>, isChecked: boolean): void {\r\n    if (element) {\r\n      var value: string = (element.currentTarget as any).value;\r\n\r\n      if (isChecked === false) {\r\n        this.removeSelected(value);\r\n      }\r\n      else {\r\n        this.getStateItemFromKey(value).isChecked = true;\r\n        this.state.selectedKeys.push(value);\r\n        this.setState(this.state);\r\n      }\r\n      this.delayedValidate(this.state.selectedKeys);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * @function\r\n   * Validates the new custom field value\r\n   */\r\n  private validate(value: string[]): void {\r\n    if (this.props.onGetErrorMessage === null || this.props.onGetErrorMessage === undefined) {\r\n      this.notifyAfterValidate(this.props.selectedItems, value);\r\n      return;\r\n    }\r\n\r\n    var result: string | PromiseLike<string> = this.props.onGetErrorMessage(value || []);\r\n    if (result !== undefined) {\r\n      if (typeof result === 'string') {\r\n        if (result === undefined || result === '')\r\n          this.notifyAfterValidate(this.props.selectedItems, value);\r\n        this.state.errorMessage = result;\r\n        this.setState(this.state);\r\n      }\r\n      else {\r\n        result.then((errorMessage: string) => {\r\n          if (errorMessage === undefined || errorMessage === '')\r\n            this.notifyAfterValidate(this.props.selectedItems, value);\r\n          this.state.errorMessage = errorMessage;\r\n          this.setState(this.state);\r\n        });\r\n      }\r\n    }\r\n    else {\r\n      this.notifyAfterValidate(this.props.selectedItems, value);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * @function\r\n   * Notifies the parent Web Part of a property value change\r\n   */\r\n  private notifyAfterValidate(oldValue: string[], newValue: string[]) {\r\n    if (this.props.onPropertyChange && newValue != null) {\r\n      this.props.properties[this.props.targetProperty] = newValue;\r\n      this.props.onPropertyChange(this.props.targetProperty, oldValue, newValue);\r\n      if (!this.props.disableReactivePropertyChanges && this.props.render != null)\r\n        this.props.render();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * @function\r\n   * Called when the component will unmount\r\n   */\r\n  public componentWillUnmount() {\r\n    this.async.dispose();\r\n  }\r\n\r\n  private sortDescending(elm?: any): void {\r\n    this.state.results.sort((a: IChoiceGroupOption, b: IChoiceGroupOption): any => {\r\n      if (this.props.sortBy == ISortableListOrder.Key) {\r\n        return (a.key > b.key) ? 1 : ((b.key > a.key) ? -1 : 0);\r\n      }\r\n      else {\r\n        return (a.text > b.text) ? 1 : ((b.text > a.text) ? -1 : 0);\r\n      }\r\n    });\r\n    this.setState(this.state);\r\n  }\r\n\r\n  private sortAscending(elm?: any): void {\r\n    this.state.results.sort((a: IChoiceGroupOption, b: IChoiceGroupOption): any => {\r\n      if (this.props.sortBy == ISortableListOrder.Key) {\r\n        return (a.key > b.key) ? -1 : ((b.key > a.key) ? 1 : 0);\r\n      }\r\n      else {\r\n        return (a.text > b.text) ? -1 : ((b.text > a.text) ? 1 : 0);\r\n      }\r\n    });\r\n    this.setState(this.state);\r\n  }\r\n\r\n  /**\r\n   * @function\r\n   * Renders the SPListMultiplePicker controls with Office UI  Fabric\r\n   */\r\n  public render(): JSX.Element {\r\n\r\n        var styleOfLabel: any = {\r\n          color: this.props.disabled === true ? '#A6A6A6' : 'auto',\r\n          width: '160px',\r\n          overflow: 'hidden',\r\n          textOverflow: 'ellipsis',\r\n          whiteSpace: 'nowrap'\r\n        };\r\n        //Renders content\r\n        return (\r\n          <div>\r\n            <Label>{this.props.label}</Label>\r\n            <div style={{position: 'absolute', right: '0', marginRight: '20px', zIndex: 998}}>\r\n              <table style={{width: '100%', borderSpacing: 0}}>\r\n                  <tbody>\r\n                    <tr>\r\n                      <td><IconButton iconProps={ { iconName: 'ChevronUp' } } onClick={this.sortDescending} disabled={this.props.disabled}></IconButton></td>\r\n                      <td><IconButton iconProps={ { iconName: 'ChevronDown' } } onClick={this.sortAscending} disabled={this.props.disabled}></IconButton></td>\r\n                    </tr>\r\n                  </tbody>\r\n              </table>\r\n            </div>\r\n            {this.state.results.map((item: IChoiceGroupOption, index: number) => {\r\n              var uniqueKey = this.props.targetProperty + '-' + item.key;\r\n              var checked = item.isChecked != null && item.isChecked !== undefined ? item.isChecked : false;\r\n              return (\r\n                <div className=\"ms-ChoiceField\" key={this._key + '-sortablelistpicker-' + index}>\r\n                  <Checkbox\r\n                    checked={checked}\r\n                    disabled={this.props.disabled}\r\n                    label={item.text}\r\n                    onChange={this.onChanged}\r\n                    inputProps={{value: item.key}}\r\n                  />\r\n                </div>\r\n              );\r\n            })\r\n            }\r\n            { this.state.errorMessage != null && this.state.errorMessage != '' && this.state.errorMessage != undefined ?\r\n              <div style={{paddingBottom: '8px'}}><div aria-live='assertive' className='ms-u-screenReaderOnly' data-automation-id='error-message'>{  this.state.errorMessage }</div>\r\n              <span>\r\n                <p className='ms-TextField-errorMessage ms-u-slideDownIn20'>{ this.state.errorMessage }</p>\r\n              </span>\r\n              </div>\r\n            : ''}\r\n          </div>\r\n        );\r\n  }\r\n\r\n}\r\n"],"sourceRoot":"..\\src"}