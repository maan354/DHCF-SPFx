{"version":3,"sources":["PropertyFieldColorPickerMiniHost.tsx"],"names":[],"mappings":"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","file":"PropertyFieldColorPickerMiniHost.js","sourcesContent":["/**\r\n * @file PropertyFieldColorPickerMiniHost.tsx\r\n * Renders the controls for PropertyFieldColorPickerMini component\r\n *\r\n * @copyright 2016 Olivier Carpentier\r\n * Released under MIT licence\r\n */\r\nimport * as React from 'react';\r\nimport { IPropertyFieldColorPickerMiniPropsInternal } from './PropertyFieldColorPickerMini';\r\nimport { ColorPicker } from 'office-ui-fabric-react/lib/ColorPicker';\r\nimport { Button } from 'office-ui-fabric-react/lib/Button';\r\nimport { Callout } from 'office-ui-fabric-react/lib/Callout';\r\nimport { Label } from 'office-ui-fabric-react/lib/Label';\r\nimport { Async } from 'office-ui-fabric-react/lib/Utilities';\r\n\r\n/**\r\n * @interface\r\n * PropertyFieldColorPickerMiniHost properties interface\r\n *\r\n */\r\nexport interface IPropertyFieldColorPickerMiniHostProps extends IPropertyFieldColorPickerMiniPropsInternal {\r\n}\r\n\r\nexport interface IPropertyFieldColorPickerMiniHostState {\r\n  color?: string;\r\n  calloutVisible: boolean;\r\n  isHover: boolean;\r\n  errorMessage?: string;\r\n}\r\n\r\n/**\r\n * @class\r\n * Renders the controls for PropertyFieldColorPickerMini component\r\n */\r\nexport default class PropertyFieldColorPickerMiniHost extends React.Component<IPropertyFieldColorPickerMiniHostProps, IPropertyFieldColorPickerMiniHostState> {\r\n\r\n  private latestValidateValue: string;\r\n  private async: Async;\r\n  private delayedValidate: (value: string) => void;\r\n  private menuButtonElement: HTMLElement;\r\n\r\n  /**\r\n   * @function\r\n   * Constructor\r\n   */\r\n  constructor(props: IPropertyFieldColorPickerMiniHostProps) {\r\n    super(props);\r\n\r\n    //Inits state\r\n    var defaultColor: string = '#FFFFFF';\r\n    if (this.props.initialColor && this.props.initialColor != '')\r\n      defaultColor = this.props.initialColor;\r\n    this.state = {\r\n        color: defaultColor,\r\n        calloutVisible: false,\r\n        isHover: false,\r\n        errorMessage: ''\r\n    };\r\n\r\n    this.onClickButton = this.onClickButton.bind(this);\r\n    this.onMouseEnterButton = this.onMouseEnterButton.bind(this);\r\n    this.onMouseLeaveButton = this.onMouseLeaveButton.bind(this);\r\n    this.async = new Async(this);\r\n    this.validate = this.validate.bind(this);\r\n    this.notifyAfterValidate = this.notifyAfterValidate.bind(this);\r\n    this.delayedValidate = this.async.debounce(this.validate, this.props.deferredValidationTime);\r\n\r\n    //Bind the current object to the external called onSelectDate method\r\n    this.onColorChanged = this.onColorChanged.bind(this);\r\n  }\r\n\r\n  /**\r\n   * @function\r\n   * Function called when the ColorPicker Office UI Fabric component selected color changed\r\n   */\r\n  private onColorChanged(color: string): void {\r\n    this.state.color = color;\r\n    this.setState(this.state);\r\n    this.delayedValidate(color);\r\n  }\r\n\r\n  /**\r\n   * @function\r\n   * Validates the new custom field value\r\n   */\r\n  private validate(value: string): void {\r\n    if (this.props.onGetErrorMessage === null || this.props.onGetErrorMessage === undefined) {\r\n      this.notifyAfterValidate(this.props.initialColor, value);\r\n      return;\r\n    }\r\n\r\n    if (this.latestValidateValue === value)\r\n      return;\r\n    this.latestValidateValue = value;\r\n\r\n    var result: string | PromiseLike<string> = this.props.onGetErrorMessage(value || '');\r\n    if (result !== undefined) {\r\n      if (typeof result === 'string') {\r\n        if (result === undefined || result === '')\r\n          this.notifyAfterValidate(this.props.initialColor, value);\r\n        this.state.errorMessage = result;\r\n        this.setState(this.state);\r\n      }\r\n      else {\r\n        result.then((errorMessage: string) => {\r\n          if (errorMessage === undefined || errorMessage === '')\r\n            this.notifyAfterValidate(this.props.initialColor, value);\r\n          this.state.errorMessage = errorMessage;\r\n          this.setState(this.state);\r\n        });\r\n      }\r\n    }\r\n    else {\r\n      this.notifyAfterValidate(this.props.initialColor, value);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * @function\r\n   * Notifies the parent Web Part of a property value change\r\n   */\r\n  private notifyAfterValidate(oldValue: string, newValue: string) {\r\n    if (this.props.onPropertyChange && newValue != null) {\r\n      this.props.properties[this.props.targetProperty] = newValue;\r\n      this.props.onPropertyChange(this.props.targetProperty, oldValue, newValue);\r\n      if (!this.props.disableReactivePropertyChanges && this.props.render != null)\r\n        this.props.render();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * @function\r\n   * Called when the component will unmount\r\n   */\r\n  public componentWillUnmount() {\r\n    if (this.async !== undefined)\r\n      this.async.dispose();\r\n  }\r\n\r\n  /**\r\n   * @function\r\n   * Called when the color button is clicked\r\n   */\r\n  private onClickButton(): void {\r\n    if (this.props.disabled === true)\r\n      return;\r\n    this.state.calloutVisible = !this.state.calloutVisible;\r\n    this.setState(this.state);\r\n  }\r\n\r\n  private onMouseEnterButton(): void {\r\n    if (this.props.disabled === true)\r\n      return;\r\n    this.state.isHover = true;\r\n    this.setState(this.state);\r\n  }\r\n\r\n  private onMouseLeaveButton(): void {\r\n    if (this.props.disabled === true)\r\n      return;\r\n    this.state.isHover = false;\r\n    this.setState(this.state);\r\n  }\r\n\r\n  /**\r\n   * @function\r\n   * Renders the control\r\n   */\r\n  public render(): JSX.Element {\r\n    //Renders content\r\n    return (\r\n      <div>\r\n        <Label>{this.props.label}</Label>\r\n        <div ref={ (menuButton) => this.menuButtonElement = menuButton }\r\n          style={{width: '70px', height: '35px',\r\n          backgroundColor: this.state.isHover ? '#eaeaea' : '#F4F4F4',\r\n          padding: '6px',\r\n          cursor: this.props.disabled === true ? 'default' : 'pointer',\r\n          borderBottomLeftRadius: '5px', borderBottomRightRadius: '5px', borderTopLeftRadius: '5px', borderTopRightRadius: '5px'}}\r\n          onClick={this.onClickButton}\r\n          onMouseEnter={this.onMouseEnterButton}\r\n          onMouseLeave={this.onMouseLeaveButton}\r\n          role=\"button\">\r\n          <div style={{ width: '100%', height: '100%', backgroundColor: this.state.color}}>\r\n          </div>\r\n        </div>\r\n        { this.state.calloutVisible && (\r\n          <Callout\r\n              className='ms-CalloutExample-callout'\r\n              gapSpace={ 0 }\r\n              targetElement={ this.menuButtonElement }\r\n              setInitialFocus={ true }\r\n              onDismiss={this.onClickButton}\r\n            >\r\n            <ColorPicker\r\n              color={this.state.color}\r\n              onColorChanged={this.onColorChanged}\r\n            />\r\n          </Callout>\r\n        )}\r\n        { this.state.errorMessage != null && this.state.errorMessage != '' && this.state.errorMessage != undefined ?\r\n              <div style={{paddingBottom: '8px'}}><div aria-live='assertive' className='ms-u-screenReaderOnly' data-automation-id='error-message'>{  this.state.errorMessage }</div>\r\n              <span>\r\n                <p className='ms-TextField-errorMessage ms-u-slideDownIn20'>{ this.state.errorMessage }</p>\r\n              </span>\r\n              </div>\r\n            : ''}\r\n      </div>\r\n    );\r\n  }\r\n}"],"sourceRoot":"..\\src"}