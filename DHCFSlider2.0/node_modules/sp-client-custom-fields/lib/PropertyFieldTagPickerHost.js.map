{"version":3,"sources":["PropertyFieldTagPickerHost.tsx"],"names":[],"mappings":"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","file":"PropertyFieldTagPickerHost.js","sourcesContent":["/**\r\n * @file PropertyFieldTagPickerHost.tsx\r\n * Renders the controls for PropertyFieldTagPicker component\r\n *\r\n * @copyright 2017 Olivier Carpentier\r\n * Released under MIT licence\r\n */\r\nimport * as React from 'react';\r\nimport { IPropertyFieldTagPickerPropsInternal, IPropertyFieldTag } from './PropertyFieldTagPicker';\r\nimport { Label } from 'office-ui-fabric-react/lib/Label';\r\nimport { Async } from 'office-ui-fabric-react/lib/Utilities';\r\nimport { TagPicker, IBasePickerSuggestionsProps, ITag } from 'office-ui-fabric-react/lib/Pickers';\r\n\r\n/**\r\n * @interface\r\n * PropertyFieldTagPickerHost properties interface\r\n *\r\n */\r\nexport interface IPropertyFieldTagPickerHostProps extends IPropertyFieldTagPickerPropsInternal {\r\n}\r\n\r\nexport interface IPropertyFieldTagPickerState {\r\n  errorMessage: string;\r\n}\r\n\r\n/**\r\n * @class\r\n * Renders the controls for PropertyFieldTagPicker component\r\n */\r\nexport default class PropertyFieldTagPickerHost extends React.Component<IPropertyFieldTagPickerHostProps, IPropertyFieldTagPickerState> {\r\n\r\n  private async: Async;\r\n  private delayedValidate: (value: IPropertyFieldTag[]) => void;\r\n\r\n  /**\r\n   * @function\r\n   * Constructor\r\n   */\r\n  constructor(props: IPropertyFieldTagPickerHostProps) {\r\n    super(props);\r\n\r\n    this.async = new Async(this);\r\n    this.state = { errorMessage: ''};\r\n\r\n    //Bind the current object to the external called onSelectDate method\r\n    this.onItemChanged = this.onItemChanged.bind(this);\r\n    this.onFilterChanged = this.onFilterChanged.bind(this);\r\n    this.listContainsTag = this.listContainsTag.bind(this);\r\n    this.validate = this.validate.bind(this);\r\n    this.notifyAfterValidate = this.notifyAfterValidate.bind(this);\r\n    this.delayedValidate = this.async.debounce(this.validate, this.props.deferredValidationTime);\r\n  }\r\n\r\n  /**\r\n   * @function\r\n   * Validates the new custom field value\r\n   */\r\n  private validate(value: IPropertyFieldTag[]): void {\r\n    if (this.props.onGetErrorMessage === null || this.props.onGetErrorMessage === undefined) {\r\n      this.notifyAfterValidate(this.props.selectedTags, value);\r\n      return;\r\n    }\r\n\r\n    var result: string | PromiseLike<string> = this.props.onGetErrorMessage(value || []);\r\n    if (result !== undefined) {\r\n      if (typeof result === 'string') {\r\n        if (result === undefined || result === '')\r\n          this.notifyAfterValidate(this.props.selectedTags, value);\r\n        this.setState({ errorMessage: result} as IPropertyFieldTagPickerState);\r\n      }\r\n      else {\r\n        result.then((errorMessage: string) => {\r\n          if (errorMessage === undefined || errorMessage === '')\r\n            this.notifyAfterValidate(this.props.selectedTags, value);\r\n          this.setState({ errorMessage } as IPropertyFieldTagPickerState);\r\n        });\r\n      }\r\n    }\r\n    else {\r\n      this.notifyAfterValidate(this.props.selectedTags, value);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * @function\r\n   * Notifies the parent Web Part of a property value change\r\n   */\r\n  private notifyAfterValidate(oldValue: IPropertyFieldTag[], newValue: IPropertyFieldTag[]) {\r\n    this.props.properties[this.props.targetProperty] = newValue;\r\n    this.props.onPropertyChange(this.props.targetProperty, oldValue, newValue);\r\n    if (!this.props.disableReactivePropertyChanges && this.props.render != null)\r\n        this.props.render();\r\n  }\r\n\r\n  /**\r\n   * @function\r\n   * Called when the component will unmount\r\n   */\r\n  public componentWillUnmount() {\r\n    if (this.async !== undefined)\r\n      this.async.dispose();\r\n  }\r\n\r\n  /**\r\n   * @function\r\n   * Called when the TagPicker text changed\r\n   * @param filterText\r\n   * @param tagList\r\n   */\r\n  private onFilterChanged(filterText: string, tagList: ITag[]) {\r\n    return filterText ? this.props.tags.filter(tag => tag.name.toLowerCase().indexOf(filterText.toLowerCase()) === 0).filter(item => !this.listContainsTag(item, tagList)) : [];\r\n  }\r\n\r\n  /**\r\n   * @function\r\n   * Tests if the selected list contains already the tag\r\n   * @param tag\r\n   * @param tagList\r\n   */\r\n  private listContainsTag(tag: ITag, tagList: ITag[]) {\r\n    if (!tagList || !tagList.length || tagList.length === 0) {\r\n      return false;\r\n    }\r\n    return tagList.filter(compareTag => compareTag.key === tag.key).length > 0;\r\n  }\r\n\r\n  /**\r\n   * @function\r\n   * Occurs when the list of selected items changed\r\n   * @param selectedItems\r\n   */\r\n  private onItemChanged(selectedItems: ITag[]): void {\r\n    this.delayedValidate(selectedItems);\r\n  }\r\n\r\n  /**\r\n   * @function\r\n   * Renders the controls\r\n   */\r\n  public render(): JSX.Element {\r\n    //Renders content\r\n    return (\r\n      <div style={{ marginBottom: '8px'}}>\r\n        <Label>{this.props.label}</Label>\r\n        <TagPicker\r\n          onResolveSuggestions={ this.onFilterChanged }\r\n          getTextFromItem= {(item: ITag) => { return item.name; } }\r\n          defaultSelectedItems={this.props.selectedTags}\r\n          onChange={this.onItemChanged}\r\n          pickerSuggestionsProps={\r\n            {\r\n              suggestionsHeaderText: this.props.suggestionsHeaderText,\r\n              noResultsFoundText: this.props.noResultsFoundText,\r\n              loadingText: this.props.loadingText\r\n            }\r\n          }\r\n        />\r\n        { this.state.errorMessage != null && this.state.errorMessage != '' && this.state.errorMessage != undefined ?\r\n          <div><div aria-live='assertive' className='ms-u-screenReaderOnly' data-automation-id='error-message'>{  this.state.errorMessage }</div>\r\n          <span>\r\n            <p className='ms-TextField-errorMessage ms-u-slideDownIn20'>{ this.state.errorMessage }</p>\r\n          </span>\r\n          </div>\r\n        : ''}\r\n      </div>\r\n    );\r\n  }\r\n}\r\n"],"sourceRoot":"..\\src"}