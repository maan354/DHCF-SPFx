{"version":3,"sources":["PropertyFieldDimensionPickerHost.tsx"],"names":[],"mappings":"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","file":"PropertyFieldDimensionPickerHost.js","sourcesContent":["/**\r\n * @file PropertyFieldDimensionPickerHost.tsx\r\n * Renders the controls for PropertyFieldDimensionPicker component\r\n *\r\n * @copyright 2017 Olivier Carpentier\r\n * Released under MIT licence\r\n */\r\nimport * as React from 'react';\r\nimport { IPropertyFieldDimensionPickerPropsInternal, IPropertyFieldDimension } from './PropertyFieldDimensionPicker';\r\nimport { Label } from 'office-ui-fabric-react/lib/Label';\r\nimport { Dropdown, IDropdownOption } from 'office-ui-fabric-react/lib/Dropdown';\r\nimport { Async } from 'office-ui-fabric-react/lib/Utilities';\r\nimport { Checkbox } from 'office-ui-fabric-react/lib/Checkbox';\r\nimport { TextField } from 'office-ui-fabric-react/lib/TextField';\r\nimport GuidHelper from './GuidHelper';\r\n\r\nimport * as strings from 'sp-client-custom-fields/strings';\r\n\r\n/**\r\n * @interface\r\n * PropertyFieldDimensionPickerHost properties interface\r\n *\r\n */\r\nexport interface IPropertyFieldDimensionPickerHostProps extends IPropertyFieldDimensionPickerPropsInternal {\r\n}\r\n\r\nexport interface IPropertyFieldDimensionPickerState {\r\n  width?: number;\r\n  height?: number;\r\n  widthUnit?: string;\r\n  heightUnit?: string;\r\n  conserveRatio?: boolean;\r\n  errorMessage: string;\r\n}\r\n\r\n/**\r\n * @class\r\n * Renders the controls for PropertyFieldDimensionPicker component\r\n */\r\nexport default class PropertyFieldDimensionPickerHost extends React.Component<IPropertyFieldDimensionPickerHostProps, IPropertyFieldDimensionPickerState> {\r\n\r\n  private async: Async;\r\n  private delayedValidate: (value: IPropertyFieldDimension) => void;\r\n  private _key: string;\r\n  private units: IDropdownOption[] = [\r\n    { key: 'px', text: 'px'},\r\n    { key: '%', text: '%'}\r\n  ];\r\n\r\n  /**\r\n   * @function\r\n   * Constructor\r\n   */\r\n  constructor(props: IPropertyFieldDimensionPickerHostProps) {\r\n    super(props);\r\n\r\n    this._key = GuidHelper.getGuid();\r\n    this.async = new Async(this);\r\n\r\n    this.state = ({\r\n      errorMessage: '',\r\n      width: 0,\r\n      height: 0,\r\n      widthUnit: 'px',\r\n      heightUnit: 'px',\r\n      conserveRatio: this.props.preserveRatio\r\n    } as IPropertyFieldDimensionPickerState);\r\n    this.loadDefaultData();\r\n\r\n    //Bind the current object to the external called onSelectDate method\r\n    this.onWidthChanged = this.onWidthChanged.bind(this);\r\n    this.onHeightChanged = this.onHeightChanged.bind(this);\r\n    this.onWidthUnitChanged = this.onWidthUnitChanged.bind(this);\r\n    this.onHeightUnitChanged = this.onHeightUnitChanged.bind(this);\r\n    this.onRatioChanged = this.onRatioChanged.bind(this);\r\n    this.saveDimension = this.saveDimension.bind(this);\r\n    this.validate = this.validate.bind(this);\r\n    this.notifyAfterValidate = this.notifyAfterValidate.bind(this);\r\n    this.delayedValidate = this.async.debounce(this.validate, this.props.deferredValidationTime);\r\n  }\r\n\r\n  /**\r\n   * @function\r\n   * Function called to load data from the initialValue\r\n   */\r\n  private loadDefaultData(): void {\r\n    if (this.props.initialValue != null && this.props.initialValue !== undefined) {\r\n      if (this.props.initialValue.width != null && this.props.initialValue.width !== undefined) {\r\n        if (this.props.initialValue.width.indexOf('px') > -1) {\r\n          this.state.widthUnit = 'px';\r\n          this.state.width = Math.round(+this.props.initialValue.width.replace('px', ''));\r\n        }\r\n        else if (this.props.initialValue.height.indexOf('%') > -1) {\r\n          this.state.widthUnit = '%';\r\n          this.state.width = Math.round(+this.props.initialValue.width.replace('%', ''));\r\n        }\r\n      }\r\n      if (this.props.initialValue.height != null && this.props.initialValue.height !== undefined) {\r\n        if (this.props.initialValue.height.indexOf('px') > -1) {\r\n          this.state.heightUnit = 'px';\r\n          this.state.height = Math.round(+this.props.initialValue.height.replace('px', ''));\r\n        }\r\n        else if (this.props.initialValue.height.indexOf('%') > -1) {\r\n          this.state.heightUnit = '%';\r\n          this.state.height = Math.round(+this.props.initialValue.height.replace('%', ''));\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * @function\r\n   * Function called when the width changed\r\n   */\r\n  private onWidthChanged(newValue: any): void {\r\n    if (this.state.widthUnit === this.state.heightUnit && this.state.conserveRatio === true && this.props.preserveRatioEnabled === true) {\r\n      if (this.state.width != 0)\r\n        this.state.height = Math.round((this.state.height / this.state.width) * +newValue);\r\n    }\r\n    this.state.width = Math.round(+newValue);\r\n    this.setState(this.state);\r\n    this.saveDimension();\r\n  }\r\n\r\n  /**\r\n   * @function\r\n   * Function called when the height changed\r\n   */\r\n  private onHeightChanged(newValue: any): void {\r\n    if (this.state.widthUnit === this.state.heightUnit && this.state.conserveRatio === true && this.props.preserveRatioEnabled === true) {\r\n      if (this.state.height != 0)\r\n        this.state.width = Math.round((this.state.width / this.state.height) * +newValue);\r\n    }\r\n    this.state.height = Math.round(+newValue);\r\n    this.setState(this.state);\r\n    this.saveDimension();\r\n  }\r\n\r\n  /**\r\n   * @function\r\n   * Function called when the width unit changed\r\n   */\r\n  private onWidthUnitChanged(element?: IDropdownOption): void {\r\n    if (element != null) {\r\n      var newValue: string = element.key.toString();\r\n      this.state.widthUnit = newValue;\r\n      this.setState(this.state);\r\n      this.saveDimension();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * @function\r\n   * Function called when the height unit changed\r\n   */\r\n  private onHeightUnitChanged(element?: IDropdownOption): void {\r\n    if (element != null) {\r\n      var newValue: string = element.key.toString();\r\n      this.state.heightUnit = newValue;\r\n      this.setState(this.state);\r\n      this.saveDimension();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * @function\r\n   * Function called when the ratio changed\r\n   */\r\n  private onRatioChanged(element: any, isChecked: boolean): void {\r\n     if (element) {\r\n      this.state.conserveRatio = isChecked;\r\n      this.setState(this.state);\r\n     }\r\n  }\r\n\r\n  /**\r\n   * @function\r\n   * Saves the dimension\r\n   */\r\n  private saveDimension(): void {\r\n    var dimension: IPropertyFieldDimension = {\r\n      width: this.state.width + this.state.widthUnit,\r\n      height: this.state.height + this.state.heightUnit\r\n    };\r\n    this.delayedValidate(dimension);\r\n  }\r\n\r\n  /**\r\n   * @function\r\n   * Validates the new custom field value\r\n   */\r\n  private validate(value: IPropertyFieldDimension): void {\r\n    if (this.props.onGetErrorMessage === null || this.props.onGetErrorMessage === undefined) {\r\n      this.notifyAfterValidate(this.props.initialValue, value);\r\n      return;\r\n    }\r\n\r\n    var result: string | PromiseLike<string> = this.props.onGetErrorMessage(value || '');\r\n    if (result !== undefined) {\r\n      if (typeof result === 'string') {\r\n        if (result === undefined || result === '')\r\n          this.notifyAfterValidate(this.props.initialValue, value);\r\n        this.setState({ errorMessage: result} as IPropertyFieldDimensionPickerState);\r\n      }\r\n      else {\r\n        result.then((errorMessage: string) => {\r\n          if (errorMessage === undefined || errorMessage === '')\r\n            this.notifyAfterValidate(this.props.initialValue, value);\r\n          this.setState({ errorMessage } as IPropertyFieldDimensionPickerState);\r\n        });\r\n      }\r\n    }\r\n    else {\r\n      this.notifyAfterValidate(this.props.initialValue, value);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * @function\r\n   * Notifies the parent Web Part of a property value change\r\n   */\r\n  private notifyAfterValidate(oldValue: IPropertyFieldDimension, newValue: IPropertyFieldDimension) {\r\n    this.props.properties[this.props.targetProperty] = newValue;\r\n    this.props.onPropertyChange(this.props.targetProperty, oldValue, newValue);\r\n    if (!this.props.disableReactivePropertyChanges && this.props.render != null)\r\n        this.props.render();\r\n  }\r\n\r\n  /**\r\n   * @function\r\n   * Called when the component will unmount\r\n   */\r\n  public componentWillUnmount() {\r\n    if (this.async != null)\r\n      this.async.dispose();\r\n  }\r\n\r\n  /**\r\n   * @function\r\n   * Renders the controls\r\n   */\r\n  public render(): JSX.Element {\r\n\r\n    //Renders content\r\n    return (\r\n      <div style={{ marginBottom: '8px'}}>\r\n        <Label>{this.props.label}</Label>\r\n\r\n        <table style={{paddingTop: '10px'}}>\r\n          <tbody>\r\n            <tr>\r\n              <td style={{verticalAlign: 'top', minWidth: '55px'}}>\r\n                <Label disabled={this.props.disabled}>{strings.DimensionWidth}</Label>\r\n              </td>\r\n              <td style={{verticalAlign: 'top', width: '80px'}}>\r\n                <TextField\r\n                  disabled={this.props.disabled}\r\n                  role=\"textbox\"\r\n                  aria-multiline=\"false\"\r\n                  type=\"number\"\r\n                  min='0'\r\n                  value={this.state.width !== undefined ? this.state.width.toString():''}\r\n                  onChanged={this.onWidthChanged}\r\n                />\r\n              </td>\r\n              <td style={{verticalAlign: 'top'}}>\r\n                <Dropdown\r\n                  label=\"\" options={this.units} selectedKey={this.state.widthUnit}\r\n                  disabled={this.props.disabled}\r\n                  onChanged={this.onWidthUnitChanged}\r\n                />\r\n              </td>\r\n            </tr>\r\n            <tr>\r\n              <td style={{verticalAlign: 'top', minWidth: '55px'}}>\r\n                <Label disabled={this.props.disabled}>{strings.DimensionHeight}</Label>\r\n              </td>\r\n              <td style={{verticalAlign: 'top', width: '80px'}}>\r\n                <TextField\r\n                  disabled={this.props.disabled}\r\n                  role=\"textbox\"\r\n                  aria-multiline=\"false\"\r\n                  type=\"number\"\r\n                  min='0'\r\n                  value={this.state.height !== undefined ? this.state.height.toString():''}\r\n                  onChanged={this.onHeightChanged}\r\n                />\r\n              </td>\r\n              <td style={{verticalAlign: 'top'}}>\r\n                <Dropdown\r\n                  label=\"\" options={this.units} selectedKey={this.state.heightUnit}\r\n                  disabled={this.props.disabled}\r\n                  onChanged={this.onHeightUnitChanged}\r\n                />\r\n              </td>\r\n            </tr>\r\n            { this.props.preserveRatioEnabled === true ?\r\n            <tr>\r\n              <td></td>\r\n              <td colSpan={2}>\r\n                <div className=\"ms-ChoiceField\" style={{paddingLeft: '0px'}}>\r\n                  <Checkbox\r\n                    checked={this.state.conserveRatio}\r\n                    disabled={this.props.disabled}\r\n                    label={strings.DimensionRatio}\r\n                    onChange={this.onRatioChanged}\r\n                  />\r\n                </div>\r\n              </td>\r\n            </tr>\r\n            : ''}\r\n          </tbody>\r\n        </table>\r\n\r\n        { this.state.errorMessage != null && this.state.errorMessage != '' && this.state.errorMessage != undefined ?\r\n          <div><div aria-live='assertive' className='ms-u-screenReaderOnly' data-automation-id='error-message'>{  this.state.errorMessage }</div>\r\n          <span>\r\n            <p className='ms-TextField-errorMessage ms-u-slideDownIn20'>{ this.state.errorMessage }</p>\r\n          </span>\r\n          </div>\r\n        : ''}\r\n      </div>\r\n    );\r\n  }\r\n}\r\n"],"sourceRoot":"..\\src"}