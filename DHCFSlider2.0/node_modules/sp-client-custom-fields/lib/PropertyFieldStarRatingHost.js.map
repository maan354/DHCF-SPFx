{"version":3,"sources":["PropertyFieldStarRatingHost.tsx"],"names":[],"mappings":"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","file":"PropertyFieldStarRatingHost.js","sourcesContent":["/**\r\n * @file PropertyFieldStarRatingHost.tsx\r\n * Renders the controls for PropertyFieldStarRating component\r\n *\r\n * @copyright 2017 Olivier Carpentier\r\n * Released under MIT licence\r\n */\r\nimport * as React from 'react';\r\nimport { IPropertyFieldStarRatingPropsInternal } from './PropertyFieldStarRating';\r\nimport { Label } from 'office-ui-fabric-react/lib/Label';\r\nimport { Async } from 'office-ui-fabric-react/lib/Utilities';\r\n//import StarRatingComponent from 'react-star-rating-component';\r\nimport GuidHelper from './GuidHelper';\r\n\r\nvar StarRatingComponent: any = require('react-star-rating-component/dist/react-star-rating-component');\r\n\r\n\r\n/**\r\n * @interface\r\n * PropertyFieldStarRatingHost properties interface\r\n *\r\n */\r\nexport interface IPropertyFieldStarRatingHostProps extends IPropertyFieldStarRatingPropsInternal {\r\n}\r\n\r\nexport interface IPropertyFieldStarRatingState {\r\n  currentValue?: number;\r\n  errorMessage: string;\r\n}\r\n\r\n/**\r\n * @class\r\n * Renders the controls for PropertyFieldStarRating component\r\n */\r\nexport default class PropertyFieldStarRatingHost extends React.Component<IPropertyFieldStarRatingHostProps, IPropertyFieldStarRatingState> {\r\n\r\n  private async: Async;\r\n  private delayedValidate: (value: number) => void;\r\n  private _key: string;\r\n\r\n  /**\r\n   * @function\r\n   * Constructor\r\n   */\r\n  constructor(props: IPropertyFieldStarRatingHostProps) {\r\n    super(props);\r\n\r\n    this._key = GuidHelper.getGuid();\r\n    this.async = new Async(this);\r\n    this.state = {\r\n      errorMessage: '',\r\n      currentValue: this.props.initialValue !== undefined ? this.props.initialValue : 0\r\n    };\r\n\r\n    //Bind the current object to the external called onSelectDate method\r\n    this.onStarClick = this.onStarClick.bind(this);\r\n    this.validate = this.validate.bind(this);\r\n    this.notifyAfterValidate = this.notifyAfterValidate.bind(this);\r\n    this.delayedValidate = this.async.debounce(this.validate, this.props.deferredValidationTime);\r\n  }\r\n\r\n  /**\r\n   * @function\r\n   * Validates the new custom field value\r\n   */\r\n  private validate(value: number): void {\r\n    if (this.props.onGetErrorMessage === null || this.props.onGetErrorMessage === undefined) {\r\n      this.notifyAfterValidate(this.props.initialValue, value);\r\n      return;\r\n    }\r\n\r\n    var result: string | PromiseLike<string> = this.props.onGetErrorMessage(value || 0);\r\n    if (result !== undefined) {\r\n      if (typeof result === 'string') {\r\n        if (result === undefined || result === '')\r\n          this.notifyAfterValidate(this.props.initialValue, value);\r\n        this.setState({ errorMessage: result} as IPropertyFieldStarRatingState);\r\n      }\r\n      else {\r\n        result.then((errorMessage: string) => {\r\n          if (errorMessage === undefined || errorMessage === '')\r\n            this.notifyAfterValidate(this.props.initialValue, value);\r\n          this.setState({ errorMessage } as IPropertyFieldStarRatingState);\r\n        });\r\n      }\r\n    }\r\n    else {\r\n      this.notifyAfterValidate(this.props.initialValue, value);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * @function\r\n   * Notifies the parent Web Part of a property value change\r\n   */\r\n  private notifyAfterValidate(oldValue: number, newValue: number) {\r\n    this.props.properties[this.props.targetProperty] = newValue;\r\n    this.props.onPropertyChange(this.props.targetProperty, oldValue, newValue);\r\n    if (!this.props.disableReactivePropertyChanges && this.props.render != null)\r\n        this.props.render();\r\n  }\r\n\r\n  /**\r\n   * @function\r\n   * Called when the component will unmount\r\n   */\r\n  public componentWillUnmount() {\r\n    this.async.dispose();\r\n  }\r\n\r\n  private onStarClick(nextValue: any, prevValue: any, name: string) {\r\n    this.state.currentValue = nextValue;\r\n    this.setState(this.state);\r\n    this.delayedValidate(nextValue);\r\n  }\r\n\r\n  /**\r\n   * @function\r\n   * Renders the controls\r\n   */\r\n  public render(): JSX.Element {\r\n    //Renders content\r\n    return (\r\n      <div style={{ marginBottom: '8px'}}>\r\n        <Label>{this.props.label}</Label>\r\n        <div style={{fontSize: this.props.starSize}}>\r\n          <StarRatingComponent\r\n              name={this._key}\r\n              starCount={this.props.starCount}\r\n              starColor={this.props.starColor}\r\n              emptyStarColor={this.props.emptyStarColor}\r\n              value={this.state.currentValue}\r\n              editing={!this.props.disabled}\r\n              onStarClick={this.onStarClick}\r\n              renderStarIcon={null}\r\n              renderStarIconHalf={null}\r\n          />\r\n        </div>\r\n        { this.state.errorMessage != null && this.state.errorMessage != '' && this.state.errorMessage != undefined ?\r\n          <div><div aria-live='assertive' className='ms-u-screenReaderOnly' data-automation-id='error-message'>{  this.state.errorMessage }</div>\r\n          <span>\r\n            <p className='ms-TextField-errorMessage ms-u-slideDownIn20'>{ this.state.errorMessage }</p>\r\n          </span>\r\n          </div>\r\n        : ''}\r\n      </div>\r\n    );\r\n  }\r\n}\r\n"],"sourceRoot":"..\\src"}